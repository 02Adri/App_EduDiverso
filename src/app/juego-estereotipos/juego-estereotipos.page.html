<ion-header class="header-bar"> 
  <ion-toolbar color="secondary" class="toolbar-game">
    <!-- Botón volver -->
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/violencia-genero" text="Volver" icon="chevron-back-outline" class="btn-back"></ion-back-button>
    </ion-buttons>
    <ion-title class="game-title">🎮 Juego: Estereotipo de Género</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding game-content">

  <!-- Antes de iniciar -->
  <div *ngIf="!juegoIniciado && !juegoFinalizado" class="intro-container">
    <ion-item class="input-name">
      <ion-label position="stacked">👤 Ingresa tu nombre</ion-label>
      <ion-input [(ngModel)]="jugador"></ion-input>
    </ion-item>
    <ion-button expand="block" (click)="prepararJuego()" class="btn-start animate-btn">
      🚀 Comenzar
    </ion-button>
  </div>

  <!-- Cuenta regresiva -->
  <div *ngIf="mostrandoCuenta" class="countdown">
    <h1 class="countdown-number">{{ cuentaRegresiva }}</h1>
  </div>

  <!-- Juego en progreso -->
  <div *ngIf="juegoIniciado && !juegoFinalizado" class="juego-contenedor">
    <!-- Vidas -->
    <div class="vidas life-container">
      <ion-icon name="heart" *ngFor="let vida of [].constructor(vidas)" color="danger" class="life-icon"></ion-icon>
    </div>

    <!-- Pregunta -->
    <div class="pregunta question-box">
      <h2 class="question-text">{{ preguntas[preguntaActual].texto }}</h2>
    </div>

    <!-- Timer -->
    <div class="timer timer-box">
      <p class="timer-text">⏳ Tiempo: {{ tiempoRestante }}s</p>
    </div>

    <!-- Opciones -->
    <div class="opciones options-container">
      <ion-button expand="block" color="success" (click)="responder(true)" class="option-btn yes-btn animate-btn">✅ Sí</ion-button>
      <ion-button expand="block" color="danger" (click)="responder(false)" class="option-btn no-btn animate-btn">❌ No</ion-button>
    </div>

    <!-- Animación de puntos -->
    <div *ngIf="mostrarAnimacionPuntos" class="animacion-puntos">+1 🎉</div>

    <!-- Animación de pérdida de vida -->
    <div *ngIf="mostrarAnimacionVida" class="animacion-vida">-1 ❤️</div>
  </div>

  <!-- Resultado final -->
  <div *ngIf="juegoFinalizado" class="resultado result-box">
    <h2 class="result-title">{{ mensajeFinal }}</h2>
    <p class="result-score">🏅 Puntuación: {{ puntuacion }}</p>
    <ion-button expand="block" (click)="guardarPuntuacion()" class="btn-save animate-btn">💾 Guardar Puntuación</ion-button>
    <ion-button expand="block" (click)="reiniciarJuego()" class="btn-restart animate-btn">🔄 Jugar de Nuevo</ion-button>
    <ion-button expand="block" color="tertiary" (click)="mostrarRanking()" class="btn-ranking animate-btn">🏆 Ver Ranking</ion-button>
  </div>

  <!-- Modal de Ranking -->
  <ion-modal [isOpen]="rankingAbierto" (didDismiss)="rankingAbierto=false" class="ranking-modal">
    <ng-template>
      <ion-header class="ranking-header">
        <ion-toolbar color="dark" class="ranking-toolbar">
          <ion-title class="ranking-title">🏆 Ranking de Puntuaciones</ion-title>
          <ion-buttons slot="end">
            <ion-button (click)="rankingAbierto=false" class="btn-close">❌ Cerrar</ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>

      <ion-content class="ion-padding ranking-content">
        <ion-list class="ranking-list">
          <ion-item *ngFor="let registro of puntuacionesGuardadas; let i = index" class="ranking-item">
            <ion-label>
              <h2>{{ i + 1 }}. {{ registro.nombre }}</h2>
              <p>
                Puntos: {{ registro.puntos }} | 
                Éxito: {{ registro.porcentaje }}% | 
                🥇 Insignia: {{ registro.insignia }}
              </p>
            </ion-label>
          </ion-item>
        </ion-list>
      </ion-content>
    </ng-template>
  </ion-modal>

</ion-content>
